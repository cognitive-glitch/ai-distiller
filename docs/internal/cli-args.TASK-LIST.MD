# AI Distiller CLI Arguments - Comprehensive Test Task List

## Critical Issues Found

### üö® HIGH PRIORITY BUGS
1. **SEGMENTATION FAULT**: `aid --help-extended` crashes with segfault - CRITICAL stability issue
2. **Missing help topics**: Several help commands mentioned but need verification

## Test Setup Requirements

Create standardized test project structure:
```
test_project/
‚îú‚îÄ‚îÄ .git/                  # Git repo with 10+ commits
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.py           # Python: public/private functions, comments, docstrings, imports
‚îÇ   ‚îú‚îÄ‚îÄ component.ts      # TypeScript: public/protected/internal, decorators
‚îÇ   ‚îú‚îÄ‚îÄ utils.go          # Go: exported/unexported functions
‚îÇ   ‚îî‚îÄ‚îÄ Service.java      # Java: public/private/protected methods
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ config.json
‚îî‚îÄ‚îÄ .gitignore
```

## 1. Core I/O and Execution

### Path Arguments
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Directory processing | `aid ./test_project/src` | Processes all files in src/, creates .aid/ output | ‚è≥ |
| Single file | `aid ./test_project/src/main.py` | Processes only main.py, creates .aid.main.py.txt | ‚è≥ |
| Current directory | `aid .` | Processes current directory files | ‚è≥ |
| Absolute path | `aid /full/path/to/project` | Processes using absolute path | ‚è≥ |

### Output Control
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Custom output file | `aid ./test_project/src -o custom.txt` | All output in custom.txt, no .aid/ folder | ‚è≥ |
| Stdout only | `aid ./test_project/src/main.py --stdout` | Prints to console, verify file behavior | ‚è≥ |
| Stdout + file | `aid ./test_project/src -o out.txt --stdout` | Output to BOTH out.txt AND stdout | ‚è≥ |
| Default naming | `aid ./test_project/src` | Creates .aid.src.pub.txt (default options) | ‚è≥ |

### Format Options
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Text format (default) | `aid ./test_project/src --format text` | Compact text with `<file path="...">` tags | ‚è≥ |
| Markdown format | `aid ./test_project/src --format md` | Markdown with emojis, headers, structure | ‚è≥ |
| JSONL format | `aid ./test_project/src --format jsonl` | One JSON object per line | ‚è≥ |
| JSON structured | `aid ./test_project/src --format json-structured` | Single well-formed JSON object | ‚è≥ |
| XML format | `aid ./test_project/src --format xml` | Valid XML structure | ‚è≥ |

### Worker Control
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Auto workers (default) | `aid ./test_project/src -w 0` | Uses automatic worker count | ‚è≥ |
| Serial processing | `aid ./test_project/src -w 1` | Single-threaded processing | ‚è≥ |
| Multiple workers | `aid ./test_project/src -w 4` | Uses 4 worker threads | ‚è≥ |

### Version Info
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Version display | `aid --version` | Shows version string and exits | ‚è≥ |

## 2. AI Actions (10 total)

### Prompt Generation Actions
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Refactoring prompt | `aid ./test_project/src --ai-action prompt-for-refactoring-suggestion` | Creates REFACTORING-SUGGESTION.timestamp.md | ‚è≥ |
| Complex codebase | `aid ./test_project --ai-action prompt-for-complex-codebase-analysis` | Creates COMPLEX-CODEBASE-ANALYSIS.timestamp.md | ‚è≥ |
| Security analysis | `aid ./test_project/src --ai-action prompt-for-security-analysis` | Creates SECURITY-ANALYSIS.timestamp.md | ‚è≥ |
| Performance analysis | `aid ./test_project/src --ai-action prompt-for-performance-analysis` | Creates PERFORMANCE-ANALYSIS.timestamp.md | ‚è≥ |
| Best practices | `aid ./test_project/src --ai-action prompt-for-best-practices-analysis` | Creates BEST-PRACTICES-ANALYSIS.timestamp.md | ‚è≥ |
| Bug hunting | `aid ./test_project/src --ai-action prompt-for-bug-hunting` | Creates BUG-HUNTING-ANALYSIS.timestamp.md | ‚è≥ |
| Single file docs | `aid ./test_project/src/main.py --ai-action prompt-for-single-file-docs` | Creates SINGLE-FILE-DOCS.timestamp.md | ‚è≥ |
| Diagrams | `aid ./test_project/src --ai-action prompt-for-diagrams` | Creates DIAGRAMS-ANALYSIS.timestamp.md | ‚è≥ |

### Flow Generation Actions
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Deep analysis flow | `aid ./test_project/src --ai-action flow-for-deep-file-to-file-analysis` | Creates .aid/ directory with ANALYSIS-TASK-LIST.md | ‚è≥ |
| Multi-file docs flow | `aid ./test_project/src --ai-action flow-for-multi-file-docs` | Creates .aid/ directory with DOCS-TASK-LIST.md | ‚è≥ |

### AI Action Output Control
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Custom AI output | `aid ./test_project/src --ai-action prompt-for-security-analysis --ai-output security.md` | Output goes to security.md | ‚è≥ |
| Template variables | `aid ./test_project/src --ai-action prompt-for-refactoring-suggestion --ai-output "refactor-%%YYYY-MM-DD%%.md"` | Uses date in filename | ‚è≥ |

## 3. Visibility Filtering (0/1 syntax)

### Individual Visibility Flags
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Public only (default) | `aid ./test_project/src/main.py` | Shows only public functions/classes | ‚è≥ |
| Disable public | `aid ./test_project/src/main.py --public 0` | Hides public members (output mostly empty) | ‚è≥ |
| Enable private | `aid ./test_project/src/main.py --private 1` | Shows private members (underscored in Python) | ‚è≥ |
| Enable protected | `aid ./test_project/src/component.ts --protected 1` | Shows protected members in TypeScript | ‚è≥ |
| Enable internal | `aid ./test_project/src/component.ts --internal 1` | Shows internal/package-private members | ‚è≥ |
| All visibility levels | `aid ./test_project/src --public 1 --private 1 --protected 1 --internal 1` | Shows all visibility levels | ‚è≥ |

## 4. Content Filtering (0/1 syntax)

### Content Include/Exclude
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Include comments | `aid ./test_project/src/main.py --comments 1` | Shows regular comments (# in Python) | ‚è≥ |
| Exclude docstrings | `aid ./test_project/src/main.py --docstrings 0` | Hides docstrings (default: 1) | ‚è≥ |
| Include implementation | `aid ./test_project/src/main.py --implementation 1` | Shows function/method bodies | ‚è≥ |
| Exclude imports | `aid ./test_project/src/main.py --imports 0` | Hides import statements (default: 1) | ‚è≥ |
| Exclude annotations | `aid ./test_project/src/component.ts --annotations 0` | Hides decorators/annotations (default: 1) | ‚è≥ |

## 5. Alternative Filtering

### Category-based Filtering
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Include only specific | `aid ./test_project/src --include-only=private,comments` | Shows ONLY private members and comments | ‚è≥ |
| Exclude specific | `aid ./test_project/src --exclude-items=implementation,comments` | Excludes implementations and comments | ‚è≥ |
| Override precedence | `aid ./test_project/src --implementation 1 --exclude-items=implementation` | exclude-items should win over individual flags | ‚è≥ |

### Valid Categories
Test all valid category names:
- `public`, `protected`, `internal`, `private`
- `comments`, `docstrings`, `implementation`, `imports`, `annotations`

## 6. File Selection Patterns

### Include/Exclude Patterns
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Include specific types | `aid ./test_project --include="*.py,*.ts"` | Processes only Python and TypeScript files | ‚è≥ |
| Exclude patterns | `aid ./test_project/src --exclude="*.go"` | Excludes Go files | ‚è≥ |
| Complex patterns | `aid ./test_project --include="*.py" --exclude="*main*"` | Python files except those with 'main' | ‚è≥ |
| Multiple includes | `aid ./test_project --include "*.py" --include "*.ts"` | Test multiple --include flags | ‚è≥ |
| Multiple excludes | `aid ./test_project --exclude "*test*" --exclude "*.json"` | Test multiple --exclude flags | ‚è≥ |

### Precedence Testing
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Conflicting patterns | `aid ./test_project --include="*.py" --exclude="*.py"` | Should exclude win? No files processed? | ‚è≥ |

## 7. Special Processing Modes

### Raw Mode
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Raw processing | `aid ./test_project/src/main.py --raw` | Outputs raw text, no parsing | ‚è≥ |
| Raw ignores filters | `aid ./test_project/src/main.py --raw --private 0` | --private 0 should be ignored | ‚è≥ |

### Language Override
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Force language | `echo "func main() {}" | aid --lang go --stdout` | Parses stdin as Go code | ‚è≥ |
| Auto detection | `echo "def main():" | aid --lang auto --stdout` | Auto-detects as Python | ‚è≥ |

### Experimental Features
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Tree-sitter parser | `aid ./test_project/src --tree-sitter` | Uses tree-sitter parser (experimental) | ‚è≥ |

### Recursion Control
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Non-recursive | `aid ./test_project -r 0` | Processes only root files, not subdirectories | ‚è≥ |
| Recursive (default) | `aid ./test_project -r 1` | Processes all subdirectories | ‚è≥ |

## 8. Git History Mode

### Git Mode Activation
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Git history default | `aid .git` | Shows last 200 commits (default limit) | ‚è≥ |
| Limited commits | `aid .git --git-limit=5` | Shows only last 5 commits | ‚è≥ |
| All commits | `aid .git --git-limit=0` | Shows entire commit history | ‚è≥ |
| With AI prompt | `aid .git --git-limit=10 --with-analysis-prompt` | Includes comprehensive AI analysis prompt | ‚è≥ |

## 9. Path Control

### Path Format Control
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Relative paths (default) | `aid ./test_project/src --file-path-type relative` | Shows relative paths in output | ‚è≥ |
| Absolute paths | `aid ./test_project/src --file-path-type absolute` | Shows absolute paths in output | ‚è≥ |
| Custom prefix | `aid ./test_project/src --relative-path-prefix "source/"` | Prefixes relative paths with "source/" | ‚è≥ |

## 10. Help & Diagnostics

### Help Commands
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Basic help | `aid --help` | Shows basic help (works) | ‚úÖ |
| Extended help | `aid --help-extended` | üö® CRASHES - segmentation fault | ‚ùå |
| Actions help | `aid help actions` | Shows AI actions documentation (works) | ‚úÖ |
| Filtering help | `aid help filtering` | Shows filtering documentation | ‚è≥ |
| Git help | `aid help git` | Shows git mode documentation | ‚è≥ |
| Cheat sheet | `aid --cheat` | Shows quick reference card | ‚è≥ |

### Diagnostic Options
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Verbose level 1 | `aid ./test_project/src -v` | Shows basic processing info | ‚è≥ |
| Verbose level 2 | `aid ./test_project/src -vv` | Shows detailed processing info | ‚è≥ |
| Verbose level 3 | `aid ./test_project/src -vvv` | Shows full trace with data dumps | ‚è≥ |
| Strict mode | `aid ./broken_project --strict` | Fails on first syntax error | ‚è≥ |

## 11. Critical Interaction Tests

### Filter Precedence
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| include-only wins | `aid ./test_project/src --public 1 --include-only=private` | Only private shown, --public ignored | ‚è≥ |
| exclude-items wins | `aid ./test_project/src --implementation 1 --exclude-items=implementation` | Implementation excluded despite --implementation 1 | ‚è≥ |

### AI Action + Format
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| AI action format | `aid ./test_project/src --ai-action prompt-for-security-analysis --format jsonl` | Behavior unclear - needs clarification | ‚è≥ |

### Raw Mode Override
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Raw overrides all | `aid ./test_project/src --raw --implementation 0 --lang python` | Raw text output, all flags ignored | ‚è≥ |

## 12. Edge Cases & Error Handling

### Invalid Arguments
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Invalid format | `aid ./test_project/src --format invalid` | Error message, non-zero exit | ‚è≥ |
| Invalid AI action | `aid ./test_project/src --ai-action nonexistent` | Error message, non-zero exit | ‚è≥ |
| Invalid language | `aid ./test_project/src --lang cobol` | Error message, non-zero exit | ‚è≥ |

### File System Edge Cases
| Test | Command | Expected Result | Status |
|------|---------|----------------|--------|
| Non-existent path | `aid ./nonexistent` | Error message, non-zero exit | ‚è≥ |
| Permission denied | `aid /root` | Error message about permissions | ‚è≥ |
| Empty directory | `aid ./empty_dir` | Handles gracefully | ‚è≥ |

## Test Execution Strategy

### Phase 1: Critical Functionality (Priority High)
1. Fix segfault in --help-extended
2. Test all Core I/O options
3. Test all AI actions
4. Verify visibility and content filtering

### Phase 2: Advanced Features (Priority Medium)
1. Test file selection patterns
2. Test special modes
3. Test git mode
4. Test path control

### Phase 3: Edge Cases (Priority Low)
1. Test all interactions
2. Test error handling
3. Performance testing with large codebases

## Expected Findings

### Likely Issues
1. **CRITICAL**: --help-extended segfault
2. Filter precedence unclear/inconsistent
3. AI action + format interaction undefined
4. Some help topics might not exist
5. Error messages might be inconsistent

### Success Criteria
- All flags work as documented
- No crashes or segfaults
- Consistent error handling
- Clear precedence rules
- All help topics accessible

## Notes for Implementation

- Use `--stdout` for most tests to see output immediately
- Create comprehensive test project with multiple languages
- Document any discrepancies between help text and behavior
- File bug reports for crashes and inconsistencies
- Update CLAUDE.md with corrected documentation

---

**Generated**: 2025-06-19
**Status**: Ready for systematic testing
**Priority**: Fix segfault first, then systematic testing by priority